<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIS2 Link Mapper - Database Collegamenti Normativi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f0f2f5;
            color: #1a1a1a;
        }
        
        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e40af 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .filters {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .filter-item input,
        .filter-item select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .filter-item input:focus,
        .filter-item select:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .link-grid {
            display: grid;
            gap: 20px;
        }
        
        .link-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .link-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border-color: #3b82f6;
        }
        
        .reference-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }
        
        .reference-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 5px;
        }
        
        .reference-type {
            display: inline-block;
            padding: 4px 12px;
            background: #eff6ff;
            color: #1e40af;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .link-section {
            margin: 15px 0;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        
        .link-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        
        .link-item a {
            color: #3b82f6;
            text-decoration: none;
            font-weight: 500;
            margin-left: 10px;
            transition: color 0.3s;
        }
        
        .link-item a:hover {
            color: #1e40af;
            text-decoration: underline;
        }
        
        .copy-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            margin-left: 10px;
            transition: background 0.3s;
        }
        
        .copy-btn:hover {
            background: #2563eb;
        }
        
        .copy-btn.copied {
            background: #10b981;
        }
        
        .description {
            color: #4b5563;
            line-height: 1.6;
            margin: 15px 0;
        }
        
        .advisera-note {
            background: #fef3c7;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #fbbf24;
        }
        
        .advisera-note h4 {
            color: #92400e;
            margin-bottom: 8px;
        }
        
        .stats-bar {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #1e40af;
        }
        
        .stat-label {
            color: #6b7280;
            font-size: 0.9em;
        }
        
        .export-section {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
        }
        
        .export-btn {
            background: #10b981;
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.3s;
        }
        
        .export-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }
        
        .no-results {
            text-align: center;
            padding: 60px;
            color: #6b7280;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>üîó NIS2 Link Mapper</h1>
        <p>Database Completo dei Collegamenti Normativi per Toolkit Advisera</p>
    </header>

    <div class="container">
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalRefs">0</div>
                <div class="stat-label">Riferimenti Totali</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="totalLinks">0</div>
                <div class="stat-label">Link Disponibili</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="totalDocs">0</div>
                <div class="stat-label">Documenti Coperti</div>
            </div>
        </div>

        <div class="filters">
            <h3>üîç Cerca e Filtra</h3>
            <div class="filter-grid">
                <div class="filter-item">
                    <input type="text" id="searchInput" placeholder="Cerca riferimento, articolo o parola chiave...">
                </div>
                <div class="filter-item">
                    <select id="typeFilter">
                        <option value="">Tutti i tipi</option>
                        <option value="direttiva">Direttiva NIS2</option>
                        <option value="decreto">Decreto Italiano</option>
                        <option value="regolamento">Regolamento UE</option>
                        <option value="iso">ISO 27001</option>
                        <option value="acn">ACN/CSIRT</option>
                    </select>
                </div>
                <div class="filter-item">
                    <select id="docFilter">
                        <option value="">Tutti i documenti</option>
                        <option value="metodologia">Metodologia valutazione rischi</option>
                        <option value="politica">Politiche sicurezza</option>
                        <option value="procedura">Procedure</option>
                        <option value="piano">Piani</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="link-grid" id="linkGrid">
            <!-- I riferimenti verranno inseriti qui dinamicamente -->
        </div>
    </div>

    <div class="export-section">
        <button class="export-btn" onclick="exportData()">üì• Esporta Database</button>
    </div>

    <script>
        // Database completo dei riferimenti normativi con link
        const referencesDatabase = [
            {
                id: 1,
                reference: "Direttiva NIS 2, Articolo 21",
                type: "direttiva",
                documents: ["metodologia", "politica", "procedura"],
                description: "Misure di gestione dei rischi di cibersicurezza - Articolo principale che definisce tutte le misure richieste",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#:~:text=Article%2021%20‚Äì%20",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#d1e3352-80-1",
                    gazzetta: null
                },
                adviseraNote: "Nei documenti Advisera, questo riferimento appare frequentemente. Il link Advisera fornisce una spiegazione dettagliata in italiano."
            },
            {
                id: 2,
                reference: "Direttiva NIS 2, Articolo 21, comma 1",
                type: "direttiva",
                documents: ["metodologia", "politica"],
                description: "Obbligo di adottare misure tecniche, operative e organizzative adeguate e proporzionate",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-1#:~:text=Member%20States%20shall%20ensure%20that%20essential",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.001",
                    gazzetta: null
                },
                adviseraNote: "Fondamentale per definire l'approccio risk-based. Nel toolkit, compilare prima la metodologia di valutazione rischi."
            },
            {
                id: 3,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (a)",
                type: "direttiva",
                documents: ["metodologia", "politica"],
                description: "Politiche di analisi dei rischi e di sicurezza dei sistemi informatici",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-a#:~:text=policies%20on%20risk%20analysis%20and%20information%20system%20security",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Richiede la 'Metodologia di valutazione dei rischi' e la 'Politica di sicurezza dei sistemi informativi'"
            },
            {
                id: 4,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (b)",
                type: "direttiva",
                documents: ["procedura"],
                description: "Gestione degli incidenti",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-b#:~:text=incident%20handling",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Documentare nella 'Procedura di gestione degli incidenti' con tempi di notifica (24h/72h)"
            },
            {
                id: 5,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (c)",
                type: "direttiva",
                documents: ["piano"],
                description: "Continuit√† operativa e gestione delle crisi",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-c#:~:text=business%20continuity",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Richiede 'Piano di continuit√† operativa' e 'Piano di gestione delle crisi'"
            },
            {
                id: 6,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (d)",
                type: "direttiva",
                documents: ["politica", "procedura"],
                description: "Sicurezza della catena di approvvigionamento",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-d#:~:text=supply%20chain%20security,%20including%20security-related%20aspects%20concerning%20the%20relationships%20between%20each%20entity%20and%20its%20direct%20suppliers%20or%20service%20providers",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Compilare 'Catalogo fornitori' e 'Politica sicurezza fornitori'"
            },
            {
                id: 7,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (e)",
                type: "direttiva",
                documents: ["procedura"],
                description: "Sicurezza nell'acquisizione, sviluppo e manutenzione",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-e#:~:text=security in network and information systems acquisition, development and maintenance, including vulnerability handling and disclosure",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Include gestione modifiche TIC e procedure di sviluppo sicuro"
            },
            {
                id: 8,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (f)",
                type: "direttiva",
                documents: ["procedura"],
                description: "Politiche e procedure per valutare l'efficacia",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-f#:~:text=policies%20and%20procedures%20to%20assess%20the%20effectiveness",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Richiede KPI, audit interni e valutazioni periodiche"
            },
            {
                id: 9,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (g)",
                type: "direttiva",
                documents: ["politica", "procedura"],
                description: "Pratiche di igiene informatica di base e formazione",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-g#:~:text=basic%20cyber%20hygiene%20practices%20and%20cybersecurity%20training",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Password policy, patch management, formazione awareness"
            },
            {
                id: 10,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (h)",
                type: "direttiva",
                documents: ["politica"],
                description: "Uso della crittografia",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-h#:~:text=policies%20and%20procedures%20regarding%20the%20use%20of%20cryptography",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Documentare in 'Politica di crittografia' - disk encryption, TLS, backup cifrati"
            },
            {
                id: 11,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (i)",
                type: "direttiva",
                documents: ["politica"],
                description: "Sicurezza delle risorse umane",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-i#:~:text=human%20resources%20security%2C%20access%20control%20policies",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Background check, onboarding/offboarding, accordi di riservatezza"
            },
            {
                id: 12,
                reference: "Direttiva NIS 2, Articolo 21, comma 2, lettera (j)",
                type: "direttiva",
                documents: ["politica"],
                description: "Controllo degli accessi e gestione degli asset",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2-j#:~:text=the%20use%20of%20multi%2Dfactor%20authentication",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.002",
                    gazzetta: null
                },
                adviseraNote: "Politica controllo accessi, MFA, registro asset informatici"
            },
            {
                id: 13,
                reference: "Direttiva NIS 2, Articolo 21, comma 3",
                type: "direttiva",
                documents: ["metodologia"],
                description: "Approccio basato sul rischio",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-3#:~:text=when%20considering%20which%20measures%20referred%20to%20in%20paragraph%202",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.003",
                    gazzetta: null
                },
                adviseraNote: "Giustifica l'approccio risk-based nella metodologia"
            },
            {
                id: 14,
                reference: "Direttiva NIS 2, Articolo 21, comma 4",
                type: "direttiva",
                documents: ["procedura"],
                description: "Misure correttive",
                links: {
                    advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-4#:~:text=an%20entity%20that%20finds%20that%20it%20does",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#021.004",
                    gazzetta: null
                },
                adviseraNote: "Documentare in 'Procedura azioni correttive'"
            },
            {
                id: 15,
                reference: "Decreto NIS2, Articolo 24",
                type: "decreto",
                documents: ["metodologia", "politica", "procedura", "piano"],
                description: "Misure di gestione dei rischi di cibersicurezza - Decreto italiano",
                links: {
                    advisera: null,
                    eurlex: null,
                    gazzetta: "https://www.gazzettaufficiale.it/atto/serie_generale/caricaArticolo?art.versione=1&art.idGruppo=4&art.flagTipoArticolo=0&art.codiceRedazionale=24G00155&art.idArticolo=24&art.idSottoArticolo=1&art.idSottoArticolo1=10&art.dataPubblicazioneGazzetta=2024-10-01&art.progressivo=0#art"
                },
                adviseraNote: "Il decreto italiano recepisce l'art. 21 della direttiva con specificazioni nazionali"
            },
            {
                id: 16,
                reference: "Regolamento di esecuzione (UE) 2024/2690",
                type: "regolamento",
                documents: ["metodologia", "politica", "procedura", "piano"],
                description: "Requisiti tecnici e metodologici dettagliati per l'attuazione delle misure",
                links: {
                    advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690#tit_1",
                    gazzetta: null
                },
                adviseraNote: "Fornisce dettagli tecnici per ogni misura dell'art. 21"
            },
            {
                id: 17,
                reference: "Regolamento (UE) 2024/2690, punto 2.1 dell'allegato",
                type: "regolamento",
                documents: ["metodologia"],
                description: "Requisiti per la gestione dei rischi",
                links: {
                    advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#2-1#:~:text=Risk%20management%20policy%20(Article%2021(2),%20point%20(a)%20of%20Directive%20(EU)%202022/2555)",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
                    gazzetta: null
                },
                adviseraNote: "Dettagli sulla metodologia di valutazione rischi"
            },
            {
                id: 18,
                reference: "Regolamento (UE) 2024/2690, punto 4.3 dell'allegato",
                type: "regolamento",
                documents: ["piano"],
                description: "Requisiti per la gestione delle crisi",
                links: {
                    advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#4-3",
                    eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
                    gazzetta: null
                },
                adviseraNote: "Specifica i contenuti del piano di gestione crisi"
            },
            {
                id: 19,
                reference: "ISO/IEC 27001, clausola 6.1",
                type: "iso",
                documents: ["metodologia"],
                description: "Azioni per affrontare rischi e opportunit√†",
                links: {
                    advisera: "https://advisera.com/iso27001/clause-6-1-actions-to-address-risks-and-opportunities/",
                    eurlex: null,
                    gazzetta: null,
                    iso: "https://www.iso.org/standard/82875.html"
                },
                adviseraNote: "Il toolkit Advisera segue la struttura ISO 27001 per la gestione rischi"
            },
            {
                id: 20,
                reference: "ISO/IEC 27001, Allegato A",
                type: "iso",
                documents: ["metodologia"],
                description: "Controlli di sicurezza",
                links: {
                    advisera: "https://advisera.com/27001academy/iso-27001-controls/",
                    eurlex: null,
                    gazzetta: null,
                    iso: "https://www.iso.org/standard/82875.html"
                },
                adviseraNote: "I controlli dell'Allegato A sono utilizzati nella tabella di trattamento rischi"
            },
            {
                id: 21,
                reference: "Determinazione ACN (2024/38565)",
                type: "acn",
                documents: ["piano"],
                description: "Piattaforma nazionale per la gestione degli incidenti",
                links: {
                    advisera: null,
                    eurlex: null,
                    gazzetta: null,
                    acn: "https://www.acn.gov.it/portale/documents/d/guest/detacn_nis_piattaforma_2024_38565"
                },
                adviseraNote: "Definisce le modalit√† di notifica incidenti all'ACN"
            },
            {
                id: 22,
                reference: "CSIRT Italia",
                type: "acn",
                documents: ["procedura"],
                description: "Computer Security Incident Response Team nazionale",
                links: {
                    advisera: null,
                    eurlex: null,
                    gazzetta: null,
                    csirt: "https://csirt.gov.it"
                },
                adviseraNote: "Riferimento per la gestione incidenti e le notifiche"
            },

{
    id: 23,
    reference: "Direttiva NIS 2, Articolo 21, comma 2",
    type: "direttiva",
    documents: ["metodologia", "politica", "procedura"],
    description: "Elenco completo delle misure di sicurezza richieste (lettere a-j)",
    links: {
        advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-2#:~:text=The%20measures%20referred%20to%20in%20paragraph%201%20",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#d1e2369-80-1",
        gazzetta: null
    },
    adviseraNote: "Questo comma contiene tutte le 10 misure obbligatorie. Assicurati di implementarle tutte."
},
{
    id: 24,
    reference: "Decreto NIS2, Articolo 24, comma 1",
    type: "decreto",
    documents: ["metodologia", "politica"],
    description: "Misure tecniche, operative e organizzative - versione italiana",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Corrisponde all'art. 21 comma 1 della direttiva"
},
{
    id: 25,
    reference: "Decreto NIS2, Articolo 24, comma 2",
    type: "decreto",
    documents: ["metodologia", "politica", "procedura"],
    description: "Dettaglio delle misure di sicurezza - versione italiana",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Corrisponde all'art. 21 comma 2 della direttiva, con le stesse lettere (a-j)"
},
{
    id: 26,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera a)",
    type: "decreto",
    documents: ["metodologia", "politica"],
    description: "Politiche di analisi dei rischi - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Versione italiana dell'art. 21, comma 2, lettera (a)"
},
{
    id: 27,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera b)",
    type: "decreto",
    documents: ["procedura"],
    description: "Gestione degli incidenti - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Notifica incidenti ad ACN secondo modalit√† italiane"
},
{
    id: 28,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera c)",
    type: "decreto",
    documents: ["piano"],
    description: "Continuit√† operativa - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Include disaster recovery e backup"
},
{
    id: 29,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera d)",
    type: "decreto",
    documents: ["politica"],
    description: "Sicurezza supply chain - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Gestione fornitori critici"
},
{
    id: 30,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera e)",
    type: "decreto",
    documents: ["procedura"],
    description: "Sicurezza sviluppo - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Change management e sviluppo sicuro"
},
{
    id: 31,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera f)",
    type: "decreto",
    documents: ["procedura"],
    description: "Valutazione efficacia - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Metriche e KPI sicurezza"
},
{
    id: 32,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera g)",
    type: "decreto",
    documents: ["politica", "procedura"],
    description: "Igiene informatica - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Patch management, password, awareness"
},
{
    id: 33,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera h)",
    type: "decreto",
    documents: ["politica"],
    description: "Crittografia - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Cifratura dati e comunicazioni"
},
{
    id: 34,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera i)",
    type: "decreto",
    documents: ["politica"],
    description: "Sicurezza HR - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Gestione personale e accessi"
},
{
    id: 35,
    reference: "Decreto NIS2, Articolo 24, comma 2, lettera j)",
    type: "decreto",
    documents: ["politica"],
    description: "MFA e controllo accessi - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Autenticazione multifattore obbligatoria"
},
{
    id: 36,
    reference: "Decreto NIS2, Articolo 24, comma 3",
    type: "decreto",
    documents: ["metodologia"],
    description: "Approccio basato sul rischio - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Proporzionalit√† delle misure"
},
{
    id: 37,
    reference: "Decreto NIS2, Articolo 24, comma 4",
    type: "decreto",
    documents: ["procedura"],
    description: "Azioni correttive - decreto italiano",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art24"
    },
    adviseraNote: "Gestione non conformit√†"
},
{
    id: 38,
    reference: "Regolamento (UE) 2024/2690, punto 2.3.3 dell'allegato",
    type: "regolamento",
    documents: ["procedura"],
    description: "Requisiti per le azioni correttive",
    links: {
        advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#2-3-3#:~:text=Independent%20review%20of%20information%20and%20network%20security",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
        gazzetta: null
    },
    adviseraNote: "Dettagli su come gestire le non conformit√†"
},
{
    id: 39,
    reference: "Regolamento (UE) 2024/2690, punto 3.6 dell'allegato",
    type: "regolamento",
    documents: ["procedura"],
    description: "Monitoraggio e miglioramento continuo",
    links: {
        advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#3-6#:~:text=Post",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
        gazzetta: null
    },
    adviseraNote: "Requisiti per il monitoraggio continuo"
},
{
    id: 40,
    reference: "Regolamento (UE) 2024/2690, punto 4.1.4 dell'allegato",
    type: "regolamento",
    documents: ["procedura"],
    description: "Gestione degli incidenti e risposta",
    links: {
        advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#4-1-4#:~:text=The%20business%20continuity%20plan%20and",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
        gazzetta: null
    },
    adviseraNote: "Processo dettagliato di incident response"
},
{
    id: 41,
    reference: "Regolamento (UE) 2024/2690, punto 6.4 dell'allegato",
    type: "regolamento",
    documents: ["procedura"],
    description: "Gestione delle modifiche",
    links: {
        advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#6-4#:~:text=Change%20management",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
        gazzetta: null
    },
    adviseraNote: "Change management per sistemi IT/OT"
},
{
    id: 42,
    reference: "Regolamento (UE) 2024/2690, punto 13 dell'allegato",
    type: "regolamento",
    documents: ["politica"],
    description: "Sicurezza fisica e ambientale",
    links: {
        advisera: "https://advisera.com/cir-2024-2690/technical-and-methodological-requirements-referred-to-in-article-2-of-this-regulation/#13#:~:text=Environmental%20and%20physical%20security",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32024R2690",
        gazzetta: null
    },
    adviseraNote: "Protezione fisica di data center e locali IT"
},
{
    id: 43,
    reference: "ISO/IEC 27001, clausola 10.1",
    type: "iso",
    documents: ["procedura"],
    description: "Non conformit√† e azioni correttive",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-requirements/#10-1#:~:text=Nonconformity%20and%20corrective%20action",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Gestione sistematica delle non conformit√†"
},
{
    id: 44,
    reference: "ISO/IEC 27001, controllo A.5.27",
    type: "iso",
    documents: ["procedura"],
    description: "Apprendimento dagli incidenti di sicurezza",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-controls/#a-5-27#:~:text=Learning%20from%20information%20security%20incidents",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Lessons learned da incidenti"
},
{
    id: 45,
    reference: "ISO/IEC 27001, controlli A.7.1-A.7.12",
    type: "iso",
    documents: ["politica"],
    description: "Controlli di sicurezza fisica",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-controls/#a-7#:~:text=Physical%20controls",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Serie completa controlli fisici e ambientali"
},
{
    id: 46,
    reference: "ISO/IEC 27001, controllo A.5.14",
    type: "iso",
    documents: ["politica"],
    description: "Trasferimento di informazioni",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-controls/#a-5-14#:~:text=Information%20transfer",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Sicurezza nelle comunicazioni e trasferimenti"
},
{
    id: 47,
    reference: "ISO/IEC 27001, controllo A.6.7",
    type: "iso",
    documents: ["politica"],
    description: "Lavoro remoto",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-controls/#a-6-7#:~:text=Remote%20working",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Politiche per smart working e accesso remoto"
},
{
    id: 48,
    reference: "ISO/IEC 27001, controllo A.8.1",
    type: "iso",
    documents: ["politica"],
    description: "Dispositivi endpoint degli utenti",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-controls/#a-8-1#:~:text=User%20endpoint%20devices",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Gestione dispositivi utente e BYOD"
},
{
    id: 49,
    reference: "ISO/IEC 27001, controllo A.8.32",
    type: "iso",
    documents: ["procedura"],
    description: "Gestione del cambiamento",
    links: {
        advisera: "https://advisera.com/27001academy/iso-27001-controls/#a-8-32#:~:text=Change%20management",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/82875.html"
    },
    adviseraNote: "Change management per modifiche IT"
},
{
    id: 50,
    reference: "ISO 22301, clausola 8.4",
    type: "iso",
    documents: ["piano"],
    description: "Procedure di continuit√† operativa",
    links: {
        advisera: "https://advisera.com/22301academy/iso-22301-requirements/#8-4#:~:text=Business%20continuity%20plans%20and%20procedures",
        eurlex: null,
        gazzetta: null,
        iso: "https://www.iso.org/standard/75106.html"
    },
    adviseraNote: "Standard per business continuity management"
},
{
    id: 51,
    reference: "Direttiva NIS 2, Articolo 21, comma 5",
    type: "direttiva",
    documents: ["politica"],
    description: "Conformit√† con norme europee e internazionali",
    links: {
        advisera: "https://advisera.com/nis2/cybersecurity-risk-management-measures/#article-21-5#:~:text=By%2017%20October%202024",
        eurlex: "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX:32022L2555#d1e2369-80-1",
        gazzetta: null
    },
    adviseraNote: "Riferimento agli standard EN e ISO applicabili"
},
{
    id: 52,
    reference: "Determinazione ACN, articolo 4",
    type: "acn",
    documents: ["piano"],
    description: "Modalit√† operative per la notifica incidenti",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: null,
        acn: "https://www.acn.gov.it/portale/documents/d/guest/detacn_nis_piattaforma_2024_38565"
    },
    adviseraNote: "Procedura italiana per notifiche attraverso la piattaforma ACN"
},
{
    id: 53,
    reference: "Decreto NIS2, Articolo 25",
    type: "decreto",
    documents: ["procedura"],
    description: "Notifica degli incidenti significativi",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art25"
    },
    adviseraNote: "Tempi e modalit√† di notifica: preallarme 24h, notifica 72h, relazione finale 1 mese"
},
{
    id: 54,
    reference: "Decreto NIS2, Articolo 26",
    type: "decreto",
    documents: ["procedura"],
    description: "Segnalazione volontaria",
    links: {
        advisera: null,
        eurlex: null,
        gazzetta: "https://www.gazzettaufficiale.it/eli/id/2024/10/01/24G00155/SG#art26"
    },
    adviseraNote: "Possibilit√† di segnalare incidenti non significativi o quasi-incidenti"
}
	    
        ];

        // Funzione per renderizzare i riferimenti
        function renderReferences(filteredRefs = referencesDatabase) {
            const grid = document.getElementById('linkGrid');
            grid.innerHTML = '';
            
            if (filteredRefs.length === 0) {
                grid.innerHTML = '<div class="no-results">Nessun riferimento trovato con i filtri selezionati.</div>';
                return;
            }
            
            filteredRefs.forEach(ref => {
                const card = document.createElement('div');
                card.className = 'link-card';
                
                let linksHtml = '';
                Object.entries(ref.links).forEach(([source, url]) => {
                    if (url) {
                        const sourceName = {
                            advisera: 'üîó Advisera',
                            eurlex: 'üá™üá∫ EUR-Lex',
                            gazzetta: 'üáÆüáπ Gazzetta Ufficiale',
                            iso: 'üìã ISO',
                            acn: 'üõ°Ô∏è ACN',
                            csirt: 'üö® CSIRT'
                        }[source] || source;
                        
                        linksHtml += `
                            <div class="link-item">
                                <span>${sourceName}:</span>
                                <a href="${url}" target="_blank">${url.substring(0, 50)}...</a>
                                <button class="copy-btn" onclick="copyLink('${url}', this)">üìã Copia</button>
                            </div>
                        `;
                    }
                });
                
                card.innerHTML = `
                    <div class="reference-header">
                        <div>
                            <h3 class="reference-title">${ref.reference}</h3>
                            <p class="description">${ref.description}</p>
                        </div>
                        <span class="reference-type">${ref.type.toUpperCase()}</span>
                    </div>
                    
                    <div class="link-section">
                        <h4>üîó Link disponibili:</h4>
                        ${linksHtml || '<p style="color: #6b7280;">Nessun link disponibile per questo riferimento</p>'}
                    </div>
                    
                    ${ref.adviseraNote ? `
                        <div class="advisera-note">
                            <h4>üí° Nota per il toolkit Advisera:</h4>
                            <p>${ref.adviseraNote}</p>
                        </div>
                    ` : ''}
                `;
                
                grid.appendChild(card);
            });
        }

        // Funzione per copiare link
        function copyLink(url, button) {
            navigator.clipboard.writeText(url).then(() => {
                const originalText = button.textContent;
                button.textContent = '‚úÖ Copiato!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Funzioni di filtro
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            const docFilter = document.getElementById('docFilter').value;
            
            const filtered = referencesDatabase.filter(ref => {
                const matchesSearch = !searchTerm || 
                    ref.reference.toLowerCase().includes(searchTerm) ||
                    ref.description.toLowerCase().includes(searchTerm) ||
                    (ref.adviseraNote && ref.adviseraNote.toLowerCase().includes(searchTerm));
                
                const matchesType = !typeFilter || ref.type === typeFilter;
                const matchesDoc = !docFilter || ref.documents.includes(docFilter);
                
                return matchesSearch && matchesType && matchesDoc;
            });
            
            renderReferences(filtered);
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('typeFilter').addEventListener('change', applyFilters);
        document.getElementById('docFilter').addEventListener('change', applyFilters);

        // Funzione per esportare i dati
        function exportData() {
            let exportText = "NIS2 LINK DATABASE - EXPORT\n";
            exportText += "=".repeat(50) + "\n\n";
            
            referencesDatabase.forEach(ref => {
                exportText += `RIFERIMENTO: ${ref.reference}\n`;
                exportText += `TIPO: ${ref.type.toUpperCase()}\n`;
                exportText += `DESCRIZIONE: ${ref.description}\n`;
                exportText += `DOCUMENTI: ${ref.documents.join(', ')}\n`;
                exportText += "\nLINK:\n";
                
                Object.entries(ref.links).forEach(([source, url]) => {
                    if (url) {
                        exportText += `  - ${source}: ${url}\n`;
                    }
                });
                
                if (ref.adviseraNote) {
                    exportText += `\nNOTA ADVISERA: ${ref.adviseraNote}\n`;
                }
                
                exportText += "\n" + "-".repeat(50) + "\n\n";
            });
            
            // Crea e scarica il file
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'NIS2_Link_Database_Export.txt';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            // Feedback visivo
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Esportato!';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        }

        // Calcola e mostra statistiche
        function updateStats() {
            document.getElementById('totalRefs').textContent = referencesDatabase.length;
            
            let totalLinks = 0;
            referencesDatabase.forEach(ref => {
                Object.values(ref.links).forEach(url => {
                    if (url) totalLinks++;
                });
            });
            document.getElementById('totalLinks').textContent = totalLinks;
            
            const uniqueDocs = new Set();
            referencesDatabase.forEach(ref => {
                ref.documents.forEach(doc => uniqueDocs.add(doc));
            });
            document.getElementById('totalDocs').textContent = uniqueDocs.size;
        }

        // Inizializzazione
        window.onload = function() {
            renderReferences();
            updateStats();
            
            // Gestione parametri URL per deep linking
            const urlParams = new URLSearchParams(window.location.search);
            const searchRef = urlParams.get('ref');
            if (searchRef) {
                document.getElementById('searchInput').value = searchRef;
                applyFilters();
            }
        };

    </script>
</body>
</html>
